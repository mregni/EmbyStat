steps:
- task: VersionJSONFile@2
  displayName: 'Version package.json'
  inputs:
    Path: '$(Build.SourcesDirectory)'
    recursion: true
    VersionNumber: '$(GitVersion.AssemblySemVer)'
    useBuildNumberDirectly: False
    VersionRegex: '\d+\.\d+\.\d+\.\d+'
    versionForJSONFileFormat: '{1}.{2}.{3}'
    FilenamePattern: 'package.json'
    OutputVersion: 'OutputedVersion'

- task: VersionDotNetCoreAssemblies@2
  displayName: 'Version .NET Core Assemblies'
  inputs:
    Path: '$(Build.SourcesDirectory)'
    VersionNumber: '$(GitVersion.AssemblySemVer)'
    Injectversion: False
    VersionRegex: '\d+\.\d+\.\d+\.\d+'
    FilenamePattern: '.csproj'
    OutputVersion: 'OutputedVersion'

- task: replacetokens@5
  displayName: Setting Rollbar settings
  inputs:
    rootDirectory: '$(Build.SourcesDirectory)\EmbyStat.Web'
    targetFiles: 'Startup.cs'
    encoding: 'auto'
    tokenPattern: 'default'
    writeBOM: true
    actionOnMissing: 'warn'
    keepToken: false
    actionOnNoFiles: 'continue'
    enableTransforms: false
    enableRecursion: false
    useLegacyPattern: false
    enableTelemetry: false